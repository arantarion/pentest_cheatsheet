# Recon

## Alive Hosts
```bash
cat all.txt | httprobe | tee -a alive2.txt

cat alive2.txt | sort -u | tee -a alive.txt
# ----------------------------------------------------------------------------------------------------------------------
```

## host

```bash
host -t a [DOMAIN] | tee -a ~/pentest/domain_info/host_t_[NAME].txt [AUTO]

host -t txt [DOMAIN] | tee -a ~/pentest/domain_info/host_t_[NAME].txt [AUTO]

host -t ns [DOMAIN] | tee -a ~/pentest/domain_info/host_t_[NAME].txt [AUTO]

host -t mx [DOMAIN] | tee -a ~/pentest/domain_info/host_t_[NAME].txt [AUTO]

host -a [DOMAIN] | tee ~/pentest/domain_info/host_a_[NAME].txt [AUTO]

host -l [DOMAIN] ns1.[DOMAIN] | tee ~/pentest/domain_info/host_l_[NAME].txt [AUTO]

host [DOMAIN] | tee ~/pentest/domain_info/host_[NAME].txt [AUTO]

# ----------------------------------------------------------------------------------------------------------------------
```

## dig
```bash
dig -x [IP] | tee ~/pentest/domain_info/dig_[NAME].txt [AUTO]

drill -x [IP] | tee ~/pentest/domain_info/drill_[NAME].txt [AUTO]

dig a [DOMAIN] | tee -a ~/pentest/domain_info/dig_a_[NAME].txt [AUTO]

dig txt [DOMAIN] | tee -a ~/pentest/domain_info/dig_a_[NAME].txt [AUTO]

dig ns [DOMAIN] | tee -a ~/pentest/domain_info/dig_a_[NAME].txt [AUTO]

dig mx [DOMAIN] | tee -a ~/pentest/domain_info/dig_a_[NAME].txt [AUTO]

dig a [DOMAIN] @ns1.[DOMAIN] | tee -a ~/pentest/domain_info/dig_a_ns_[NAME].txt [AUTO]

dig txt [DOMAIN] @ns1.[DOMAIN] | tee -a ~/pentest/domain_info/dig_a_ns_[NAME].txt [AUTO]

dig ns [DOMAIN] @ns1.[DOMAIN] | tee -a ~/pentest/domain_info/dig_a_ns_[NAME].txt [AUTO]

dig mx [DOMAIN] @ns1.[DOMAIN] | tee -a ~/pentest/domain_info/dig_a_ns_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## whois
```bash
whois [IP] | tee ~/pentest/domain_info/whois_[NAME].txt [AUTO] # -h whois.iana.org
# ----------------------------------------------------------------------------------------------------------------------
```

## nslookup
```bash
nslookup [IP] | tee ~/pentest/domain_info/nslookup_[NAME].txt [AUTO]

nslookup -query=any [DOMAIN] | tee ~/pentest/domain_info/nslookup_any_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## Banner grabbing
```bash
nc -v [DOMAIN/IP] [PORT]

telnet [DOMAIN/IP] [PORT]

curl -vX [DOMAIN/IP]
# ----------------------------------------------------------------------------------------------------------------------
```

## nmap 
```bash
sudo nmap -sSV --version-all --script all -Pn -p- -O --script-timeout=25m -vv --stylesheet https://raw.githubusercontent.com/Haxxnet/nmap-bootstrap-xsl/main/nmap-bootstrap.xsl -oA ~/pentest/nmap/tcp_all_scripts_[NAME] [IP]

# Normal TCP
sudo nmap -sSCV -O -p- --script-timeout=25m -vv --stylesheet https://raw.githubusercontent.com/Haxxnet/nmap-bootstrap-xsl/main/nmap-bootstrap.xsl -oA ~/pentest/nmap/tcp_[NAME] [IP]

# Normal UDP
sudo nmap -sUCV --top-ports 1000 --script-timeout=25m -vv --stylesheet https://raw.githubusercontent.com/Haxxnet/nmap-bootstrap-xsl/main/nmap-bootstrap.xsl -oA ~/pentest/nmap/udp_[NAME] [IP]
# ----------------------------------------------------------------------------------------------------------------------
```

## Header Info

```bash
curl -s -I [URL] | tee ~/pentest/header/simple_header_[NAME].txt [AUTO]

curl -v -s -I [URL] | tee ~/pentest/header/simple_verbose_header_[NAME].txt [AUTO]

curl -s -I -X POST [URL] | tee ~/pentest/header/xPost_header_[NAME].txt [AUTO]

curl -v -s -I -X POST [URL] | tee ~/pentest/header/xPost_header_verbose_[NAME].txt [AUTO]

curl -s -I -X GET [URL] | tee ~/pentest/header/xGet_header_[NAME].txt [AUTO]

curl -v -s -I -X GET [URL] | tee ~/pentest/header/xGet_header_verbose_[NAME].txt [AUTO]

curl -s -vv [URL] 2>&1 | grep Strict | tee ~/pentest/header/hsts_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## Hauditor

```bash
hauditor -t [URL] | tee ~/pentest/hauditor/[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## sub.sh

```bash
sub.sh -s [URL_WO_HTTPS] [AUTO]

sub.sh -a [URL_WO_HTTPS]
# ----------------------------------------------------------------------------------------------------------------------
```

## crt.sh
```bash
curl -s https://crt.sh/\?q=[DOMAIN]\&output=json | jq . | grep 'name_value' | awk '{print $2}' | sed -e 's/"//g'| sed -e 's/,//g' |  awk '{gsub(/\\n/,"\n")}1' | sort -u | tee ~/pentest/crt_sh/crt_sh_[NAME] [AUTO]

# https://crt.sh/?q=syss.de&output=json
# ----------------------------------------------------------------------------------------------------------------------
```

## dnsenum
```bash
dnsenum --noreverse -o ~/pentest/domain_info/dnsenum_[NAME] [DOMAIN] [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## dnsx
```bash
echo "[DOMAIN]" | dnsx --recon -cdn -re -o ~/pentest/domain_info/dnsx_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## TestSSL

```bash
testssl -g -e -E -s -f -p -S -P -h -U --quiet --disable-rating --severity LOW -oA ~/pentest/testssl/testssl_[NAME] [DOMAIN/IP] #-iL ~/pentest/hosts.txt --mode parallel
# ----------------------------------------------------------------------------------------------------------------------
```

## SSH-Audit
```bash
ssh-audit --level=warn [DOMAIN/IP] | tee ~/pentest/ssh_audit/ssh_audit_[NAME].txt 
# ----------------------------------------------------------------------------------------------------------------------
```

## gowitness
```bash
gowitness nmap -f ~/pentest/nmap/[FILE].xml -F --open

gowitness file -f ~/pentest/hosts.txt -F

gowitness single [URL]

gowitness scan [RANGE]

gowitness server

firefox http://localhost:7171 &
# ----------------------------------------------------------------------------------------------------------------------
```

## getJS
```bash
getJS --url [URL] --complete --resolve --ouput ~/pentest/web_technology/getjs_[NAME].txt
# ----------------------------------------------------------------------------------------------------------------------
```

## whatweb
```bash
whatweb -a=3 [URL_WO_HTTPS] | tee ~/pentest/web_technology/whatweb_[NAME].txt # -i ~/pentest/hosts.txt
# ----------------------------------------------------------------------------------------------------------------------
```

## CorsMe
```bash
echo "[URL_WO_HTTPS/URL]" | CorsMe -wildcard -output ~/pentest/cors/corsme_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## Corsy
```bash
python /home/inimicus/tools/Corsy/corsy.py -u [URL_WO_HTTPS] | tee ~/pentest/cors/corsy_[NAME].txt [AUTO]
# ----------------------------------------------------------------------------------------------------------------------
```

## hackrevdns
```bash
prips [IPRANGE] | hakrevdns | tee ~/pentest/domain_info/hakrevdns_[NAME].txt
# ----------------------------------------------------------------------------------------------------------------------
```

## CSPparse
```bash
cspparse [URL] | tee ~/pentest/csp/cspparse_[NAME].json
# ----------------------------------------------------------------------------------------------------------------------
```

## go-csp-validator
```bash
/home/inimicus/tools/go-csp-evaluator/cmd/validator/validator -input [URL_WO_HTTPS] -output ~/pentest/csp/validator_[NAME].json && python -m json.tool ~/pentest/csp/validator_[NAME].json | tee ~/pentest/csp/validator_[NAME].json [AUTO]

/home/inimicus/tools/go-csp-evaluator/cmd/validator/validator -input "[CSP]" -output ~/pentest/csp/validator_[NAME].json && python -m json.tool ~/pentest/csp/validator_[NAME].json | tee ~/pentest/csp/validator_[NAME].json
# ----------------------------------------------------------------------------------------------------------------------
```


## LinkFinder
```bash
sudo python /home/inimicus/tools/LinkFinder/linkfinder.py -d -i [URL] -o ~/pentest/enumeration/linkfinder_[NAME].html
# ----------------------------------------------------------------------------------------------------------------------
```

## Assetfinder
```bash
echo [URL] | assetfinder | tee ~/pentest/enumeration/assetfinder_[NAME].txt
# ----------------------------------------------------------------------------------------------------------------------
```

## Subfinder (?)
```bash
subfinder -d [URL] -silent | httpx -status-code -web-server -title -silent -threads 100
# ----------------------------------------------------------------------------------------------------------------------
```

## FFuF / FeroxBuster
```bash
feroxbuster -u [URL] --scan-limit 3 -w ~/Documents/wordlists/dicc.txt -x htm,html,xml,js,json,zip,asp,aspx,php,bak,sql,old,txt,gz,gz.tar --random-agent --extract-links --auto-bail -r -k -o ~/pentest/enumeration/feroxbuster_fileext_[NAME].txt

feroxbuster -u [URL] --scan-limit 3 -w ~/Documents/wordlists/apiwords.txt --random-agent --extract-links --auto-bail -r -k -o ~/pentest/enumeration/feroxbuster_api_[NAME].txt

feroxbuster -u [URL] --scan-limit 3 -w ~/Documents/wordlists/raft-large-directories.txt --random-agent -x htm,html,xml,js,json,zip,asp,aspx,php,bak,sql,old,txt,gz,gz.tar --extract-links --auto-bail -r -k -o ~/pentest/enumeration/feroxbuster_large_dir_[NAME].txt

ffuf -u [URL]/FUZZ -w ~/Documents/wordlists/dicc.txt -mc 200,301,302 -t 200 -D -e js,php,bak,txt,html,zip,sql,old,gz,log,swp,yaml,yml,config,save,rsa,ppk -ac -of html -o ~/pentest/enumeration/ffuf_files_[NAME].html

ffuf -u [URL]/FUZZ -w ~/Documents/wordlists/apiwords.txt -mc 200 -t 200 -D -e js,php,bak,txt,html,zip,sql,old,gz,log,swp,yaml,yml,config,save,rsa,ppk -ac -of html -o ~/pentest/enumeration/ffuf_api_[NAME].html

ffuf -u [URL]/FUZZ -w ~/Documents/wordlists/raft-large-files.txt -mc 200,301,302 -t 200 -of html -o ~/pentest/enumeration/ffuf_raft_files_[NAME].html

ffuf -u [URL]/FUZZ -w ~/Documents/wordlists/raft-large-directories.txt -mc 200,301,302,403 -t 200 -of html -o ~/pentest/enumeration/ffuf_raft_dirs_[NAME].html

ffuf -u [URL]/FUZZ -w ~/Documents/wordlists/dirhidden.txt -mc 200,301,302 -of html -o ~/pentest/enumeration/ffuf_hidden_[NAME].html

sudo python3 /home/inimicus/tools/dirsearch/dirsearch.py -u [URL] -e htm,html,xml,js,json,zip,asp,aspx,php,bak,sql,old,txt,gz,gz.tar -x 301,429,404,400 -t 200 -w ~/Documents/wordlists/apiwords.txt

sudo python3 /home/inimicus/tools/dirsearch/dirsearch.py -u [URL] -e htm,html,xml,js,json,zip,asp,aspx,php,bak,sql,old,txt,gz,gz.tar -x 301,502,404,400,429 -t 200
# ----------------------------------------------------------------------------------------------------------------------
```

## nikto
```bash
nikto -h [URL] -followredirects -Format htm -o ~/pentest/nikto/nikto_[NAME].html
# ----------------------------------------------------------------------------------------------------------------------
```

## wpscan
```bash
wpscan --url [URL]:[PORT] --enumerate u,t,p | tee ~/pentest/wpscan/wpscan_[NAME].txt
# ----------------------------------------------------------------------------------------------------------------------
```

## Nuclei
```bash
nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/cves/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_cves_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/files/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_files_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/panels/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_panels_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/security-misconfiguration/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_security-misconfiguration_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/technologies/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_technologies_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/tokens/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_tokens_[NAME].txt

nuclei -l alive.txt -t "/home/inimicus/nuclei-templates/vulnerabilities/*.yaml" -c 60 -o ~/pentest/nuclei/nuclei_vulnerabilities_[NAME].txt

cat * | grep -v '\[aws\]' | grep -v 'Labda' | grep -v 'CVE-2017-7529' |  grep -v 'basic-cors-misconfig' | grep -v 'Kingdee-file-list' | grep -v 'host-header-poisoning'  | grep -v '\[info]' | grep -v 'general-tokens' | grep -v 'missing-x-frame-options' |  grep -v 'Express-LFR-json' | grep -v 'ruijie-EWEB-rce' | grep -v 'seaCMS-sqli' | grep -v 'Application-dos' | grep -v 'Labda_403Bypass_slash' | grep -v 'ssl-dns-names' |  grep -v 'CVE-2018-15473' |  grep -v 'dns-waf-detect:cloudflare' | grep -v 'basic-cors-misconfig-flash' | grep -v 'openssh-username-enumeration' | grep -v 'CVE-2019-19985' | grep -v 'CVE-2019-7192' | grep -v 'jira-unauthenticated-user-picker' | grep -v Express-LFR-GET | grep -v dnssec-detection | grep -v json-endpoints | grep -v graphite | grep -iv cellpower | grep -v IOC | grep -v 'Clickhouse DB' | grep -v twig | grep -v header-reflection | grep -v header-sqli | grep -v 'graphite-browser-default-credential' | grep -v 'tech-detect' | grep -v 'nginx-version' | grep -v 'http-missing-security-headers' | grep -v 'exposed-pii' | grep -v 'apple-app-site-association' | grep -v 'developer-notes' | grep -v 'addeventlistener-detect' | grep -v 'generic-tokens' | grep -v 'base-64-strings' | grep -v 'possibility-of-webshell' | grep -vi 'cve-2020-36287' 
# ----------------------------------------------------------------------------------------------------------------------
```